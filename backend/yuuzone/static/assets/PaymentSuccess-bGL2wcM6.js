import{h as T,c as C,a as E,r as u,j as t,v as A}from"./vendor_react_core-CNRJGlP_.js";import{a as G}from"./vendor_axios-NIGUFBhG.js";import"./vendor_other-Cv4PqGe0.js";import"./vendor_socket_io_client-ClWRkI5z.js";const U=()=>{const{paymentReference:h}=T(),g=C(),{t:r}=E(),[s,j]=u.useState(null),[N,p]=u.useState(!0),[y,b]=u.useState(null);u.useEffect(()=>{const a=async()=>{var n,i,m,e,l,d,k;try{p(!0);const c=await G.get(`/api/subscriptions/payment/status/${h}`);console.log("üîç DEBUG: Payment success page received payment data:",c.data),console.log("üîç DEBUG: Payment object:",c.data.payment),console.log("üîç DEBUG: Tier information:",{tier_name:(n=c.data.payment)==null?void 0:n.tier_name,tier_slug:(i=c.data.payment)==null?void 0:i.tier_slug,tier_object:(m=c.data.payment)==null?void 0:m.tier}),j(c.data)}catch(c){((e=c.response)==null?void 0:e.status)===404?b("Payment is being processed. Please wait a moment and refresh the page."):((l=c.response)==null?void 0:l.status)===403?b("Access denied. Please make sure you are logged in."):b(((k=(d=c.response)==null?void 0:d.data)==null?void 0:k.error)||"Failed to check payment status")}finally{p(!1)}};if(h){const n=setTimeout(()=>{a()},500),i=setTimeout(()=>{s||a()},3e3);return()=>{clearTimeout(n),clearTimeout(i)}}},[h]);const v=()=>{(s==null?void 0:s.payment_type)==="coin"?g("/coin-shop"):g("/subscriptions")},f=()=>{g("/")};if(N)return t.jsx("div",{className:"min-h-screen bg-theme-light-gray2 dark:bg-theme-dark-bg flex items-center justify-center",children:t.jsx(A,{})});if(y)return t.jsx("div",{className:"min-h-screen bg-theme-light-gray2 dark:bg-theme-dark-bg flex items-center justify-center",children:t.jsx("div",{className:"bg-theme-less-white dark:bg-theme-dark-card p-8 rounded-lg shadow-lg max-w-md w-full mx-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"‚ùå"}),t.jsx("h1",{className:"text-2xl font-bold text-theme-text-primary dark:text-theme-dark-text mb-4",children:r("payment.error.title","Payment Error")}),t.jsx("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary mb-6",children:y}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-theme-blue hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors",children:r("payment.retry","Retry")}),t.jsx("button",{onClick:f,className:"w-full bg-theme-gray hover:bg-theme-light-gray text-theme-text-primary dark:text-theme-dark-text dark:bg-theme-dark-border dark:hover:bg-theme-dark-hover font-bold py-2 px-4 rounded transition-colors",children:r("common.goHome","Go Home")})]})]})})});const _=(s==null?void 0:s.status)==="completed",w=s==null?void 0:s.is_expired,x=(s==null?void 0:s.payment_type)==="coin",o=(()=>{var a,n,i,m;if(x){const e=s==null?void 0:s.payment;return{title:r("payment.success.coins.title","Coins Purchased Successfully!"),message:r("payment.success.coins.message","Your coins have been added to your wallet."),itemName:((a=e==null?void 0:e.package)==null?void 0:a.name)||"Coin Package",amount:(e==null?void 0:e.coin_amount)||0,currency:"coins",expiresAt:null,benefits:[r("payment.success.coins.benefits.wallet","Coins added to wallet"),r("payment.success.coins.benefits.immediate","Available immediately"),r("payment.success.coins.benefits.use","Ready to use for purchases")]}}else{const e=s==null?void 0:s.payment,l=(e==null?void 0:e.tier_name)||((n=e==null?void 0:e.tier)==null?void 0:n.name)||"Unknown Tier",d=(e==null?void 0:e.tier_slug)||((i=e==null?void 0:e.tier)==null?void 0:i.slug);return console.log("üîç DEBUG: Extracting tier information:",{payment_tier_name:e==null?void 0:e.tier_name,payment_tier_slug:e==null?void 0:e.tier_slug,payment_tier_object:e==null?void 0:e.tier,payment_tier_object_name:(m=e==null?void 0:e.tier)==null?void 0:m.name,final_tier_name:l,final_tier_slug:d}),{title:r("payment.success.tier.title","Tier Subscription Activated!"),message:r("payment.success.tier.message","Your tier subscription has been activated successfully."),itemName:l,tierSlug:d,amount:(e==null?void 0:e.amount)||0,currency:(e==null?void 0:e.currency)||"VND",expiresAt:s!=null&&s.expires_at?new Date(s.expires_at):null,benefits:[r("payment.success.tier.benefits.unlocked","Tier benefits unlocked"),r("payment.success.tier.benefits.immediate","Benefits available immediately"),r("payment.success.tier.benefits.realTime","Real-time updates applied")]}}})(),S=a=>{if(!a)return"";const n=a.getDate().toString().padStart(2,"0"),i=(a.getMonth()+1).toString().padStart(2,"0"),m=a.getFullYear();return`${n}/${i}/${m}`},P=a=>{if(!a)return"";const n=a.getHours().toString().padStart(2,"0"),i=a.getMinutes().toString().padStart(2,"0"),m=a.getSeconds().toString().padStart(2,"0");return`${n}:${i}:${m}`};return t.jsx("div",{className:"min-h-screen bg-theme-light-gray2 dark:bg-theme-dark-bg flex items-center justify-center p-4",children:t.jsx("div",{className:"bg-theme-less-white dark:bg-theme-dark-card p-8 rounded-lg shadow-lg max-w-md w-full",children:t.jsxs("div",{className:"text-center",children:[_&&!w?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-green-500 text-6xl mb-4",children:"‚úÖ"}),t.jsx("h1",{className:"text-2xl font-bold text-theme-text-primary dark:text-theme-dark-text mb-4",children:o.title}),t.jsx("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary mb-6",children:o.message}),t.jsxs("div",{className:"bg-theme-light-gray2 dark:bg-theme-dark-bg p-4 rounded-lg mb-6 border border-theme-border-light dark:border-theme-dark-border",children:[t.jsx("h2",{className:"text-lg font-semibold text-theme-text-primary dark:text-theme-dark-text mb-2",children:x?r("payment.success.coinInfo","Coin Information"):r("payment.success.tierInfo","Tier Information")}),t.jsx("p",{className:"text-theme-blue font-medium mb-2",children:o.itemName}),x&&o.amount>0&&t.jsxs("p",{className:"text-yellow-500 dark:text-yellow-400 font-medium mb-2",children:[o.amount," ",o.currency]}),o.expiresAt&&t.jsxs("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary text-sm",children:[r("payment.success.expiresAt","Expires at"),": ",S(o.expiresAt)," ",P(o.expiresAt)]})]}),t.jsx("div",{className:"space-y-3 mb-6",children:o.benefits.map((a,n)=>t.jsxs("div",{className:"flex items-center text-green-500",children:[t.jsx("span",{className:"mr-2",children:"‚úì"}),t.jsx("span",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary",children:a})]},n))})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-yellow-500 text-6xl mb-4",children:"‚ö†Ô∏è"}),t.jsx("h1",{className:"text-2xl font-bold text-theme-text-primary dark:text-theme-dark-text mb-4",children:r("payment.expired.title","Payment Expired")}),t.jsx("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary mb-6",children:r("payment.expired.message","This payment has expired. Please try again.")})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:v,className:"w-full bg-theme-blue hover:bg-blue-700 text-white font-bold py-3 px-4 rounded transition-colors",children:x?r("payment.success.continueToCoins","Continue to Coin Shop"):r("payment.success.continueToSubscriptions","Continue to Subscriptions")}),t.jsx("button",{onClick:f,className:"w-full bg-theme-gray hover:bg-theme-light-gray text-theme-text-primary dark:text-theme-dark-text dark:bg-theme-dark-border dark:hover:bg-theme-dark-hover font-bold py-3 px-4 rounded transition-colors",children:r("common.goHome","Go Home")})]})]})})})};export{U as default};
