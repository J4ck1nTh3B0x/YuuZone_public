import{a as T,p as F,c as D,r as s,j as e}from"./vendor_react_core-Dg1y9FT3.js";import{A as v,a as N}from"./index-DRRcW6Cm.js";import"./vendor_axios-NIGUFBhG.js";import"./vendor_other-DQuvFis3.js";import"./vendor_socket_io_client-DkBXAcY8.js";const B=()=>{const{t:r}=T(),[S]=F(),n=D(),f=S.get("token"),[b,E]=s.useState(""),[g,R]=s.useState(""),[w,C]=s.useState(""),[i,c]=s.useState(""),[m,a]=s.useState(""),[u,o]=s.useState(!1),q=async t=>{var d,l;t.preventDefault(),o(!0),a(""),c("");try{await N.post("/user/forgot-password",{email:b}),c(r("forgotPassword.resetEmailSent"))}catch(x){a(((l=(d=x.response)==null?void 0:d.data)==null?void 0:l.message)||r("forgotPassword.requestError"))}finally{o(!1)}},L=async t=>{var d,l,x,p,y,k,j,P;if(t.preventDefault(),o(!0),a(""),c(""),g!==w){a(r("forgotPassword.passwordsDoNotMatch")),o(!1);return}try{await N.post(`/user/reset-password/${f}`,{password:g}),c(r("forgotPassword.passwordResetSuccess")),setTimeout(()=>{n("/login")},2e3)}catch(h){(x=(l=(d=h.response)==null?void 0:d.data)==null?void 0:l.message)!=null&&x.includes("expired")||(k=(y=(p=h.response)==null?void 0:p.data)==null?void 0:y.message)!=null&&k.includes("invalid")?n("/password-reset-expired"):a(((P=(j=h.response)==null?void 0:j.data)==null?void 0:P.message)||r("forgotPassword.resetError"))}finally{o(!1)}};return f?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-theme-light-gray2 dark:bg-theme-dark-bg dark:text-theme-dark-text",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 p-8 bg-white dark:bg-theme-dark-card rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(v,{}),e.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900 dark:text-white",children:r("forgotPassword.resetPassword")}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:r("forgotPassword.enterNewPassword")})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:L,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:r("forgotPassword.newPassword")}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:g,onChange:t=>R(t.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:r("forgotPassword.newPasswordPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:r("forgotPassword.confirmPassword")}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:w,onChange:t=>C(t.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:r("forgotPassword.confirmPasswordPlaceholder")})]}),i&&e.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm text-center",children:i}),m&&e.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm text-center",children:m}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:u,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r(u?"common.loading":"forgotPassword.resetPassword")})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>n("/login"),className:"text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 text-sm",children:r("forgotPassword.backToLogin")})})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-theme-light-gray2 dark:bg-theme-dark-bg dark:text-theme-dark-text",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 p-8 bg-white dark:bg-theme-dark-card rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(v,{}),e.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900 dark:text-white",children:r("forgotPassword.forgotPassword")}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:r("forgotPassword.enterEmailToReset")})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:q,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:r("forgotPassword.email")}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:b,onChange:t=>E(t.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:r("forgotPassword.emailPlaceholder")})]}),i&&e.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm text-center",children:i}),m&&e.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm text-center",children:m}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:u,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r(u?"common.loading":"forgotPassword.sendResetLink")})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>n("/login"),className:"text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 text-sm",children:r("forgotPassword.backToLogin")})})]})]})})};export{B as default};
