import{i as v,c as w,a as C,r as l,j as e,v as P}from"./vendor_react_core-H2iNu-df.js";import{a as T}from"./vendor_axios-NIGUFBhG.js";import"./vendor_other-DlbOK6zg.js";import"./vendor_socket_io_client-BsysqQf1.js";const H=()=>{const{paymentReference:c}=v(),d=w(),{t:s}=C(),[t,y]=l.useState(null),[f,h]=l.useState(!0),[u,x]=l.useState(null);l.useEffect(()=>{const i=async()=>{var n,r,p,g;try{h(!0),console.log("Checking payment status for:",c);const o=await T.get(`/api/subscriptions/payment/status/${c}`);console.log("Payment status response:",o.data),y(o.data)}catch(o){console.error("Error checking payment status:",o),((n=o.response)==null?void 0:n.status)===404?x("Payment is being processed. Please wait a moment and refresh the page."):((r=o.response)==null?void 0:r.status)===403?x("Access denied. Please make sure you are logged in."):x(((g=(p=o.response)==null?void 0:p.data)==null?void 0:g.error)||"Failed to check payment status")}finally{h(!1)}};if(c){const n=setTimeout(()=>{i()},500),r=setTimeout(()=>{t||i()},3e3);return()=>{clearTimeout(n),clearTimeout(r)}}},[c]);const k=()=>{(t==null?void 0:t.payment_type)==="coin"?d("/coin-shop"):d("/subscriptions")},b=()=>{d("/")};if(f)return e.jsx("div",{className:"min-h-screen bg-theme-light-gray2 dark:bg-theme-dark-bg flex items-center justify-center",children:e.jsx(P,{})});if(u)return e.jsx("div",{className:"min-h-screen bg-theme-light-gray2 dark:bg-theme-dark-bg flex items-center justify-center",children:e.jsx("div",{className:"bg-theme-less-white dark:bg-theme-dark-card p-8 rounded-lg shadow-lg max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"❌"}),e.jsx("h1",{className:"text-2xl font-bold text-theme-text-primary dark:text-theme-dark-text mb-4",children:s("payment.error.title","Payment Error")}),e.jsx("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary mb-6",children:u}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-theme-blue hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors",children:s("payment.retry","Retry")}),e.jsx("button",{onClick:b,className:"w-full bg-theme-gray hover:bg-theme-light-gray text-theme-text-primary dark:text-theme-dark-text dark:bg-theme-dark-border dark:hover:bg-theme-dark-hover font-bold py-2 px-4 rounded transition-colors",children:s("common.goHome","Go Home")})]})]})})});const j=(t==null?void 0:t.status)==="completed",N=t==null?void 0:t.is_expired,m=(t==null?void 0:t.payment_type)==="coin",a=(()=>{var i,n;if(m){const r=t==null?void 0:t.payment;return{title:s("payment.success.coins.title","Coins Purchased Successfully!"),message:s("payment.success.coins.message","Your coins have been added to your wallet."),itemName:((i=r==null?void 0:r.package)==null?void 0:i.name)||"Coin Package",amount:(r==null?void 0:r.coin_amount)||0,currency:"coins",expiresAt:null,benefits:[s("payment.success.coins.benefits.wallet","Coins added to wallet"),s("payment.success.coins.benefits.immediate","Available immediately"),s("payment.success.coins.benefits.use","Ready to use for purchases")]}}else{const r=t==null?void 0:t.payment;return{title:s("payment.success.tier.title","Tier Subscription Activated!"),message:s("payment.success.tier.message","Your tier subscription has been activated successfully."),itemName:((n=r==null?void 0:r.tier)==null?void 0:n.name)||"Unknown Tier",amount:(r==null?void 0:r.amount)||0,currency:(r==null?void 0:r.currency)||"VND",expiresAt:t!=null&&t.expires_at?new Date(t.expires_at):null,benefits:[s("payment.success.tier.benefits.unlocked","Tier benefits unlocked"),s("payment.success.tier.benefits.immediate","Benefits available immediately"),s("payment.success.tier.benefits.realTime","Real-time updates applied")]}}})();return e.jsx("div",{className:"min-h-screen bg-theme-light-gray2 dark:bg-theme-dark-bg flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-theme-less-white dark:bg-theme-dark-card p-8 rounded-lg shadow-lg max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[j&&!N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-green-500 text-6xl mb-4",children:"✅"}),e.jsx("h1",{className:"text-2xl font-bold text-theme-text-primary dark:text-theme-dark-text mb-4",children:a.title}),e.jsx("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary mb-6",children:a.message}),e.jsxs("div",{className:"bg-theme-light-gray2 dark:bg-theme-dark-bg p-4 rounded-lg mb-6 border border-theme-border-light dark:border-theme-dark-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-theme-text-primary dark:text-theme-dark-text mb-2",children:m?s("payment.success.coinInfo","Coin Information"):s("payment.success.tierInfo","Tier Information")}),e.jsx("p",{className:"text-theme-blue font-medium mb-2",children:a.itemName}),m&&a.amount>0&&e.jsxs("p",{className:"text-yellow-500 dark:text-yellow-400 font-medium mb-2",children:[a.amount," ",a.currency]}),a.expiresAt&&e.jsxs("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary text-sm",children:[s("payment.success.expiresAt","Expires at"),": ",a.expiresAt.toLocaleDateString()," ",a.expiresAt.toLocaleTimeString()]})]}),e.jsx("div",{className:"space-y-3 mb-6",children:a.benefits.map((i,n)=>e.jsxs("div",{className:"flex items-center text-green-500",children:[e.jsx("span",{className:"mr-2",children:"✓"}),e.jsx("span",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary",children:i})]},n))})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-yellow-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h1",{className:"text-2xl font-bold text-theme-text-primary dark:text-theme-dark-text mb-4",children:s("payment.expired.title","Payment Expired")}),e.jsx("p",{className:"text-theme-text-secondary dark:text-theme-dark-text-secondary mb-6",children:s("payment.expired.message","This payment has expired. Please try again.")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:k,className:"w-full bg-theme-blue hover:bg-blue-700 text-white font-bold py-3 px-4 rounded transition-colors",children:m?s("payment.success.continueToCoins","Continue to Coin Shop"):s("payment.success.continueToSubscriptions","Continue to Subscriptions")}),e.jsx("button",{onClick:b,className:"w-full bg-theme-gray hover:bg-theme-light-gray text-theme-text-primary dark:text-theme-dark-text dark:bg-theme-dark-border dark:hover:bg-theme-dark-hover font-bold py-3 px-4 rounded transition-colors",children:s("common.goHome","Go Home")})]})]})})})};export{H as default};
